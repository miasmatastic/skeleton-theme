{% comment %}
  Block Product Card Renderer - Renders product card blocks from the universal container
{% endcomment %}

{% liquid
  assign product = all_products[block.settings.product] | default: block.settings.product
  assign show_vendor = block.settings.show_vendor | default: true
  assign show_price = block.settings.show_price | default: true
  assign show_compare_price = block.settings.show_compare_price | default: true
  assign show_badges = block.settings.show_badges | default: true
  assign image_aspect_ratio = block.settings.image_aspect_ratio | default: 'square'
  assign card_style = block.settings.card_style | default: 'standard'
  assign text_alignment = block.settings.text_alignment | default: 'left'
%}

<div class="block-product-card" 
     data-block-id="{{ block.id }}"
     data-card-style="{{ card_style }}">
  
  {% if product != blank %}
    <div class="product-card card-{{ card_style }}" 
         style="text-align: {{ text_alignment }};">
      
      {% comment %} Product Image {% endcomment %}
      <div class="product-card-image" 
           style="
             aspect-ratio: {% case image_aspect_ratio %}
               {% when 'square' %}1/1
               {% when 'portrait' %}3/4
               {% when 'landscape' %}4/3
               {% else %}auto
             {% endcase %};
             overflow: hidden;
             position: relative;
           ">
        
        {% if product.featured_media %}
          <img 
            src="{{ product.featured_media | image_url: width: 400 }}"
            alt="{{ product.featured_media.alt | default: product.title | escape }}"
            width="{{ product.featured_media.width }}"
            height="{{ product.featured_media.height }}"
            loading="lazy"
            style="width: 100%; height: 100%; object-fit: cover;"
          >
        {% else %}
          <div class="product-placeholder" 
               style="
                 width: 100%;
                 height: 100%;
                 background: var(--color-base-border);
                 display: flex;
                 align-items: center;
                 justify-content: center;
                 color: var(--color-base-text-secondary);
               ">
            <span>No Image</span>
          </div>
        {% endif %}
      </div>
      
      {% comment %} Product Info {% endcomment %}
      <div class="product-card-info" style="padding: 1rem 0;">
        <h3 class="product-title" 
            style="
              margin: 0 0 0.5rem 0;
              font-size: 1rem;
              font-weight: 600;
              line-height: 1.4;
            ">
          <a href="{{ product.url }}" 
             style="
               text-decoration: none;
               color: inherit;
             ">
            {{ product.title }}
          </a>
        </h3>
        
        {% if show_price %}
          <div class="product-price" 
               style="
                 font-weight: 600;
                 color: var(--brand-primary);
               ">
            {{ product.price | money }}
          </div>
        {% endif %}
      </div>
    </div>
  {% else %}
    {% if request.design_mode %}
      <div class="block-placeholder">
        <p>üõçÔ∏è Select a product to display</p>
      </div>
    {% endif %}
  {% endif %}
</div>